<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Function _AD_SetAccountExpire</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">_AD_SetAccountExpire</font>
<hr size="2">
<p>Modifies the specified user or computer account expiration date/time or sets the account to never expire.<br></p>

<p class="codeheader">
#Include &lt;AD.au3&gt;<br>
_AD_SetAccountExpire($sObject, $sDateTime)<br>
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">$sObject</td>
    <td width="85%">User or computer account to set expiration date/time (sAMAccountName or FQDN)</td>
  </tr>
  <tr>
   <td>$sDateTime</td>
   <td>Expiration date/time in format: yyyy-mm-dd hh:mm:ss (local time) or "01/01/1970" to never expire</td>
  </tr>
</table>

<p>&nbsp;</p>

<p><b>Return Value</b></p>
Success: 1<br>
Failure: 0, sets @error to:<br>
&nbsp;&nbsp;&nbsp; 1 - $sObject does not exist<br>
&nbsp;&nbsp;&nbsp; x - Error returned by SetInfo method (Missing permission etc.)<br>
<p>&nbsp;</p>

<p><b>Remarks</b></p>
Use the following syntax for the date/time:<br>
01/01/1970 = never expire<br>
yyyy-mm-dd hh:mm:ss= "international format" - always works<br>
xx/xx/xx <time> = "localized format" - the format depends on the local date/time settings<br>
<br>
Microsoft:<br>
The date when the account expires. This value represents the number of 100-nanosecond intervals since January 1, 1601 (UTC).<br>
A value of 0 or 0x7FFFFFFFFFFFFFFF (9223372036854775807) indicates that the account never expires.<br>
<br>
Richard L. Mueller:<br>
"In Active Directory Users and Computers you can specify the date when a user account expires on the "Account"<br>
tab of the user properties dialog. This date is stored in the accountExpires attribute of the user object.<br>
There is also a property method called AccountExpirationDate, exposed by the IADsUser interface, that can be<br>
used to display and set this date. If you've ever compared accountExpires and AccountExpirationDate with the<br>
date shown in ADUC, you may have wondered what's going on. It is common for the values to differ by a day,<br>
sometimes even two days."<br>
<br>
<p>&nbsp;</p>

<p><b>Related</b></p>

<p>&nbsp;</p>

<p><b>See Also</b></p>
http://www.rlmueller.net/AccountExpires.htm; https://msdn.microsoft.com/en-us/library/windows/desktop/ms675098(v=vs.85).aspx<br>
<p>&nbsp;</p>
</body>
</html>
